var API,global=this;if(API&&typeof API=="object"&&API.areFeatures&&API.areFeatures("attachListener","createElement","setElementText","setControlState")){API.attachDocumentReadyListener(function(){var f=API;var Aj=f.isHostMethod;var Ap=f.canAdjustStyle;var Ah=f.cancelDefault;var AM=f.createElement;var AV=f.showElement;var A2=f.attachListener;var G=f.attachDocumentListener;var AI=f.getEventTarget,u=f.getEventTargetRelated;var Au=f.getKeyboardKey;var d=f.attachDrag,x=f.attachDragToControl;var t=f.detachDragFromControl;var O=f.centerElement;var AG=f.coverDocument;var AY=f.constrainPositionToViewport;var Ak=f.maximizeElement;var Ar=f.restoreElement;var Az=f.setElementText;var A7=f.setElementHtml;var b=f.setElementNodes;var AQ=f.positionElement;var BA=f.sizeElement;var A0=f.fixElement;var k=f.getChildren;var A1=f.addClass;var A8=f.removeClass;var BI=f.hasClass;var Aw=f.getElementPositionStyle;var Ax=f.getElementSizeStyle;var V=f.getElementParentElement;var N=f.makeElementUnselectable;var Am=f.callInContext;var BF,AE,Z,K;var BB,D=AM("div");var BC=AM("div");var A4=AM("input");var r=AM("fieldset");var AB,BJ,Ai,Ag,Ay,Af,AP,Ae,At;var e=f.getBodyElement();var F,l,g,L,AT;var AK={};var C,A5,AA,AW,Av,Ao,i,BG,As,Al,m,X,I,B,A9,BH,AO,AN;var Q,Ad,a,AJ,Ab,R,Aq,y,AD,J,S,AS,Ac,q,AZ,AU,j,n,A3,z,w,AR;var A=f.setControlRole,BE=f.setWaiProperty,E=f.removeWaiProperty;var AL=f.disableControl,p=f.isControlDisabled,BD=f.checkControl,v=f.isControlChecked,AF=f.showControl;var H,c,Aa;var o=function(BN,BM,BL,BK){return Am(BN,AN||API,BM||D,BL,BK)};var h=function(BL,BK){return BL+(BK?" [Ctrl+"+BK+"]":"")};var AH=function(BL,BK){AL(BL,BK)};var U=function(BM,BK){var BL=AM("div");if(BL){BL.title=h(BM,BK);BL.className=BM.toLowerCase()+" button captionbutton";if(A){A(BL,"button")}D.appendChild(BL)}return BL};var W=function(BK){var BL=AM("input");if(BL){BL.className="commandbutton button";BL.type="button";BL.value=BK;r.appendChild(BL);if(Aa){Aa(BL)}}return BL};if(x){Ac=function(BK){(BK?t:x)(D,BF,{ondragstart:I,ondrop:B})}}var T=function(BK){if(BK){BB.style.display="block";AG(BB);if(A1){if(L.ease){A1(BB,"ease");A1(BB,"in");A8(BB,"out")}else{A8(BB,"ease")}}if(A1){A1(BB,"drawn")}L.keyClassName="drawn";AF(BB,true,L)}else{if(A8){A8(BB,"drawn");if(l.ease){A8(BB,"in");A1(BB,"out")}}AV(BB,false,{removeOnHide:true});if(A8){A8(BB,"animated")}}};S=function(BK){if(BF){if(A3){BF.title="Double-click to "+(BK?"restore":"maximize")}else{if(Ag){BF.title=BK?"Double-click to restore":""}}}};AS=function(BK){if(A1){if(BK){A8(Ai,"maximizebutton");A1(Ai,"restorebutton")}else{A8(Ai,"restorebutton");A1(Ai,"maximizebutton")}}Ai.title=h(!BK?"Maximize":"Restore",".");if(p(Ai)){Ai.title+=" (disabled)"}};J=function(BK){if(Ag){AH(Ag,BK)}if(Ai){AH(Ai,!BK&&!A3)}if(Ai){if(BK){AS(!F);if(n&&BF){S(!F)}}else{AS(F);if(n&&BF){S(F)}}}};y=function(BL,BK){BL.style.visibility=(BK)?"hidden":""};AD=function(BK){if(AE){y(AE,BK)}if(Z){y(Z,BK)}if(K){y(K,BK)}};q=function(BK){if(n){AD(BK)}if(BF){if(n){S(BK)}Ac(BK)}if(Ai){AS(BK)}if(AB){AH(AB,BK)}};if(Ak){if(BI){R=function(BK){return BI(BK,"captionbutton")}}else{R=function(BK){return BK==Ag||BK==Ai||BK==Ay||BK==AB}}Aq=function(BK){var BM,BN,BL=k(D);BM=BL.length;while(BM--){BN=BL[BM];if(!R(BN)&&BN!=BF&&BN!=BJ){BN.style.display=(BK||(BN==r&&!AR))?"none":""}}};var M=function(){if(AJ){global.setTimeout(AJ,10)}};AZ=function(BK,BL){if(BK){AK.pos=Aw(D);AK.dim=Ax(D);if(A1){A8(D,"maximized");A1(D,"minimized")}if(BF){Ac(false)}if(BK&&BH){o(BH)}}else{if(!F){if(AB&&v(AB)&&D.style.position!="fixed"){AY(AK.pos)}AQ(D,AK.pos[0],AK.pos[1],g);BA(D,AK.dim[0],AK.dim[1],g,M);if(!BA.async){M()}}if(A8){A8(D,"minimized")}if(BF){Ac(F)}}Aq(BK);if(!BK&&F){Ar(D);AU(true)}if(BK){D.style.height=D.style.width=""}J(BK)};AU=function(BK){var BL=function(){if(A1){(BK?A1:A8)(D,"maximized")}if(AJ){global.setTimeout(AJ,10)}};(BK?Ak:Ar)(D,g,BL);q(BK);if(BK&&A9){o(A9)}F=BK;if(!Ak.async){BL()}};j=function(){var BK;if(Ag&&z&&AK.dim&&p(Ag)){AZ(false);BK=true}else{if(F){AU(false);BK=true}else{BK=false}}if(BK&&AO){o(AO)}return BK};f.maximizeAlert=function(){if(!F){AU(true);return true}return false};f.restoreAlert=j;f.minimizeAlert=function(){if(Ag&&z&&!p(Ag)){AZ(true);return true}return false}}function s(){return !A5||!o(A5)}function AC(){return !AA||!o(AA)}function AX(){return !AW||!o(AW)}function An(BK){switch(w){case"confirm":case"yesno":case"dialog":return(BK?s:AC)();case"yesnocancel":if(typeof BK=="undefined"){return AX()}return(BK?s:AC)()}}function A6(){if(BB){T(false)}AV(D,false,l)}function Y(BM){var BL,BK;if(AT){if(BM){if(Av&&o(Av)===false){return false}}if(Ao&&o(Ao)===false){return false}if(!i){A6();BL=true}else{BK=o(i,l);if(typeof BK=="undefined"){A6();BL=true}else{BL=BK}}if(BL){AT=false}return !AT}return false}if(AV&&O&&BA&&f.getScrollPosition&&D&&A4&&r&&BC&&e&&Aj(global,"setTimeout")){f.dismissAlert=Y;f.getAlertElement=function(){return D};f.isAlertOpen=function(){return AT};f.isAlertModal=function(){return AT&&!a};f.deactivateAlert=c=function(){if(A1){A1(D,"background")}if(Al){o(Al)}Ad=true};f.activateAlert=H=function(){if(A8){A8(D,"background")}if(As){o(As)}Ad=false};if(Aj(A4,"focus")){Aa=function(BK){A2(BK,"focus",function(BN){if(Ab){global.clearTimeout(Ab)}var BO=u(BN);var BM=BO;while(BO&&BO!=r){BO=V(BO)}var BL=true;if(!BO&&m){BL=o(m,BK,BM)!==false}if(BL){H()}else{this.blur();return Ah(BN)}});A2(BK,"blur",function(BL){if(!a){Ab=global.setTimeout(function(){var BM=true;if(X){BM=o(X,BK,u(BL))!==false}if(BM){if(!Ag||!z||!p(Ag)){c()}}else{this.focus();return Ah(BL)}},100)}})}}if(Aa){Aa(A4)}f.focusAlert=AJ=function(){if(AT&&D.style.visibility=="visible"&&r.style.display!="none"){A4.focus()}if(H){H()}};var P=function(BK){if(!BK.disabled&&AP.style.display!="none"){BK.blur()}};f.blurAlert=function(){if(D.style.visibility=="visible"&&r.style.display!="none"){A4.blur();if(AP){P(AP)}if(Ae){P(Ae)}if(At){P(At)}if(Af){P(Af)}}if(c){c()}};A2(D,"click",function(BL){var BK;if(Ab){global.clearTimeout(Ab);Ab=null}if(Ad){H();BK=true}var BM=AI(BL);if(BK&&AJ&&(BM==this||BM==BC||BM==r||BM==BJ||BM==BF||BM==AE||BM==Z||BM==K)){AJ()}});f.setAlertDirty=function(BK,BL){if(w=="dialog"){if(typeof BL=="boolean"){A4.value=BK?"Close":"OK";if(AP){AP.disabled=BK}}if(At){At.disabled=!BK}Q=BK}};f.isAlertModal=function(){return AT&&a};if(AG){BB=AM("div");BB.className="curtain";BB.style.display="none";BB.style.visibility="hidden"}if(BE){BC.id="mylibalertcontent"}if(Ac){BF=AM("div");if(BF){BF.className="movehandle";D.appendChild(BF);if(N){N(BF)}D.style.position="absolute";Ac(false);if(AU){Ai=U("Maximize",".");if(Ai){A2(Ai,"click",function(BK){if(A3||!p(this)){if(!j()){AU(true)}}})}A2(BF,"dblclick",function(BK){if(A3||!p(Ai)){if(!j()){AU(true)}return Ah(BK)}})}BJ=AM("div");if(BJ){BJ.className="icon";if(A){A(BJ,"button")}A2(BJ,"dblclick",function(){if(!Ay||!p(Ay)){Y(false)}});A2(BJ,"click",function(){if(BG){o(BG)}});D.appendChild(BJ)}Ay=U("Close");if(Ay){A2(Ay,"click",function(){if(!p(this)){Y(false)}})}if(k&&Ap&&Ap("display")&&AZ){Ag=U("Minimize",",");if(Ag){A2(Ag,"click",function(){if(!p(this)){AZ(true)}})}}if(A0){AB=U("Fix");if(AB){BD(AB,false);A2(AB,"click",function(BK){if(!p(this)){if(!v(this)){BD(this);if(A1){A1(D,"fixed")}this.title="Detach";A0(D,true,g)}else{BD(this,false);if(A8){A8(D,"fixed")}this.title="Fix";A0(D,false,g)}if(AJ){global.setTimeout(AJ,10)}}})}}if(BA){Z=AM("div");if(Z){Z.className="sizehandleh";D.appendChild(Z);d(D,Z,{mode:"size",axes:"horizontal"})}K=AM("div");if(K){K.className="sizehandlev";D.appendChild(K);d(D,K,{mode:"size",axes:"vertical"})}AE=AM("div");if(AE){AE.className="sizehandle";D.appendChild(AE);d(D,AE,{mode:"size"})}}}}BC.className="content";D.appendChild(BC);A4.type="button";A4.value="Close";A4.className="commandbutton close";r.appendChild(A4);Ae=W("No");AP=W("Cancel");At=W("Apply");Af=W("Help");D.appendChild(r);D.style.position="absolute";AV(D,false);AQ(D,0,0);A2(A4,"click",function(){if(!w||An(true)){Y(Q)}});if(BB){e.appendChild(BB);if(AJ){A2(BB,"click",function(){AJ()})}}e.appendChild(D);if(G&&Au){G("keyup",function(BM){var BN,BL,BK;if(AT&&!BM.shiftKey&&!BM.metaKey&&!Ad){BL=Au(BM);switch(BL){case 27:if(!BM.ctrlKey){if(!Ay||!p(Ay)||An()){Y(false);return Ah(BM)}}break;case 13:if(!BM.ctrlKey){BN=AI(BM);BK=BN.tagName;if(BN.type=="text"&&/^input$/i.test(BK)){while(BN&&BN!=r){BN=V(BN)}if(BN&&(!w||An(true))){Y(Q);return Ah(BM)}}}break;default:if(AU&&n&&BM.ctrlKey){switch(BL){case 190:if(A3&&!j()){AU(true)}break;case 188:if(z&&Ag&&!p(Ag)){AZ(true)}}}}}})}if(Af){A2(Af,"click",function(){if(C){C()}})}if(AP){A2(AP,"click",function(){if(An()){Y(false)}})}if(Ae){A2(Ae,"click",function(){if(An(false)){Y(false)}})}if(At){A2(At,"click",function(){if(!Av||o(Av)!==false){Q=false;this.disabled=true;if(A4.value=="Close"){A4.value="OK";if(AP){AP.disabled=false}}}})}f.alert=function(BL,BW){var BN,BS,BQ,BR,BU,BM,BO;BW=BW||{};if(BW.effects&&typeof BW.duration=="undefined"){BW.duration=400}l=BW;g={duration:BW.duration,ease:BW.ease,fps:BW.fps};L=BW.curtain||{};w=BW.decision;AR=BW.buttons!==false;BS=BW.captionButtons!==false;BQ=BW.icon!==false;if(A){A(D,w=="dialog"?"dialog":"alertdialog");if(w=="dialog"){E(D,"described-by")}else{BE(D,"described-by","mylibalertcontent")}}if(Af){C=BW.onhelp;Af.style.display=(C)?"":"none"}if(AP){AP.style.display=(w&&w!="yesno")?"":"none"}if(Ae){Ae.style.display=(w=="yesno"||w=="yesnocancel")?"":"none"}if(Ay){AH(Ay,!!w&&w!="dialog")}if(BJ){BJ.title=w?"":"Double-click to close";if(A){A(BJ,w?"":"button")}BJ.style.visibility=(!BS||!BQ||!A1)?"hidden":""}A5=BW.onpositive;AW=BW.onindeterminate;AA=BW.onnegative;BG=BW.oniconclick;m=BW.onfocus;X=BW.onblur;As=BW.onactivate;Al=BW.ondeactivate;A9=BW.onmaximize;BH=BW.onminimize;AO=BW.restore;I=BW.ondragstart;B=BW.ondrop;AN=BW.callbackContext;Q=false;A4.value="OK";if(AP){AP.disabled=false}if(At){At.disabled=true;Av=BW.onsave;At.style.display=(BW.onsave&&w=="dialog")?"":"none"}A4.value=w?((w.indexOf("yes")!=-1)?"Yes":"OK"):"Close";if(BF){BR=BW.title;BU=typeof BR=="string";if(BU){BF.style.display="";Az(BF,BR)}else{BF.style.display="none"}}if(r){r.style.display=AR?"":"none"}Ao=BW.onclose;i=BW.onhide||arguments[3];var BT,BV=BW.onopen;if(!BT){BT=BW.onshow||arguments[2]}AV(D,false);if(!F&&BW.shrinkWrap!==false){D.style.height="";D.style.width=""}if(BB){var BK=a;a=BW.modal;if(!AT||a!=BK){T(BW.modal)}}D.className=(BW.className||"alert")+" popup window";if(!AT){BM=D.style.left;BO=D.style.top;D.style.left=D.style.top="0"}if(A7&&BW.html){A7(BC,BW.html)}else{if(b&&BW.nodes){b(BC,BW.nodes)}else{Az(BC,BL||"")}}n=BW.sizable!==false;A3=n&&BW.maximizable!==false;if(A1){if(AU){A8(D,"nomaxminbuttons");(n?A1:A8)(D,"maxminbuttons")}else{A1(D,"nomaxminbuttons")}if(BS){(BQ?A1:A8)(D,"iconic");A8(D,"nocaptionbuttons")}else{A1(D,"nocaptionbuttons")}if(A0&&BW.fixable!==false){A1(D,"fixable")}}D.style.display="block";if(Aq&&z&&Ag&&p(Ag)){Aq(false);if(F){Ar(D);if(A3){Ak(D,null,function(){if(A1){A1(D,"maximized")}})}else{F=false}q(F)}J(false)}if(Ai){if(n&&AU&&A3){AH(Ai,false)}else{AH(Ai);if(F){Ar(D);F=false}}q(!!F)}if(n){z=BW.minimizable!==false}if(Ag){if(n&&AZ&&z){AH(Ag,false)}else{AH(Ag)}}if(AD){AD(!n||F)}if(AB){AB.style.visibility=(BW.fixable!==false&&BU&&BS)?"":"hidden"}if(Ai){Ai.style.visibility=(n&&BU&&BS)?"":"hidden"}if(Ag){Ag.style.visibility=(n&&BU&&BS)?"":"hidden"}if(Ay){Ay.style.visibility=(BU&&BS)?"":"hidden"}if(BA){if(BW.shrinkWrap!==false){if(!F){D.style.height="1px";BN=D.offsetHeight;D.style.height=""}BN=D.clientLeft}var BP=Ax(D);if(BP){BA(D,BP[0],BP[1])}}if(!AT){D.style.left=BM;D.style.top=BO}if(BV){o(BV)}Ad=BW.background;if(Ad){c()}if(AT||!BT||!o(BT,D,BW,F)){if(AT){if(!AB||!v(AB)){global.setTimeout(function(){O(D,{duration:BW.duration,ease:BW.ease,fps:BW.fps},function(){if(AJ){AJ()}})},10)}AV(D)}else{if(!F){O(D)}else{Ar(D);Ak(D,null,function(){if(A1){A1(D,"maximized")}})}AV(D,true,BW)}}if(!AT&&A4&&Aj(A4,"focus")){global.setTimeout(AJ,BW.duration||0)}AT=true}}e=f=null})}