var global=this,API,D,C;if(API){API.attachDocumentReadyListener(function(){var P=API.isHostMethod,N=API.isHostObjectProperty,E=API.getDocumentWindow;var F,L,O,A,H,M,J;var G,B,K=global.document;if(P(global,"getSelection")&&E){F=function(Q){return E(Q).getSelection()}}else{if(N(global.document,"selection")){F=function(Q){return(Q||global.document).selection}}}var I=function(Q){if(typeof Q.text=="string"){return Q.text}if(P(Q,"toString")){return Q.toString()}};if(F){J=function(R){if(P(R,"toString")){return R.toString()}var Q=A(R);if(Q){return I(Q)}return""};A=function(Q){if(P(Q,"getRangeAt")){return Q.rangeCount?null:Q.getRangeAt(0)}if(P(Q,"createRange")){return Q.createRange()}return null}}if(A){O=function(S){var Q,R=F(S);if(P(R,"empty")){R.empty()}else{Q=A(R);if(Q&&P(Q,"collapse")){Q.collapse()}}}}if(O){API.clearDocumentSelection=function(Q){O(Q)}}API.getDocumentSelectionText=function(Q){return J(F(Q))};if(P(K,"createElement")){B=K.createElement("input");G=API.getBodyElement();G.appendChild(B);if(typeof B.selectionStart=="number"){H=function(R){var S=R.selectionStart,Q=R.selectionEnd;return[S,Q,R.value.substring(S,Q)]};M=function(R,S,Q){R.selectionStart=S;R.selectionEnd=Q}}else{if(A){H=function(S){var T,R,Q,V;if(P(S,"focus")){S.focus()}T=A(F());if(T){if(P(T,"duplicate")){R=T.duplicate();if(S.tagName=="INPUT"){R.expand("textedit")}else{R.moveToElementText(S)}Q=R.text.length;R.setEndPoint("starttostart",T);V=Q-R.text.length;var U=T.text.replace(/\r\n/g,"\n");return([V,V+U.length,U])}}return null};if(P(B,"createTextRange")){M=function(T,U,Q){var S,R=T.createTextRange();R.collapse();R.moveStart("character",U);R.moveEnd("character",Q-U);R.select();S=H(T);if(S[0]!=U){R.move("character",U-S[0]);R.select()}}}}}}G.removeChild(B);API.getControlSelection=H;API.setControlSelection=M;if(M){API.clearControlSelection=function(Q){M(Q,0,0)}}if(C&&C.prototype){C.prototype.setSelection=function(R,S,Q){L(R,S,Q);return this};C.prototype.getSelection=function(Q){return F(Q)}}if(D&&D.prototype){D.prototype.clearSelection=function(){O(this.node());return this};D.prototype.getSelectionText=function(){return J(this.node())}}K=B=null})}